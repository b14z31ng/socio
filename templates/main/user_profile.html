{% extends 'main/base.html' %}
{% block title %}{{ profile_user.username }}'s Profile | My Secure Social{% endblock %}
{% block content %}
<h2>{{ profile_user.username }}'s Profile</h2>
{% if profile and profile.get_profile_pic_url %}
    <img src="{{ profile.get_profile_pic_url }}" alt="Profile Picture" width="100" style="border-radius:50px;">
{% endif %}
{% if profile and profile.get_bio %}
    <p>{{ profile.get_bio }}</p>
{% endif %}

{% if request.user != profile_user %}
    {% if can_add %}
        <form action="{% url 'send_friend_request' profile_user.id %}" method="post">{% csrf_token %}
            <button type="submit">Add Friend</button>
        </form>
    {% elif can_unfriend %}
        <form action="{% url 'remove_friend' profile_user.id %}" method="post">{% csrf_token %}
            <button type="submit">Friend (Click to Unfriend)</button>
        </form>
    {% elif can_accept %}
        <form action="{% url 'accept_friend_request' req_id=profile_user.sent_friend_requests.get(to_user=request.user, status='pending').id %}" method="post">{% csrf_token %}
            <button type="submit">Accept Friend Request</button>
        </form>
    {% elif req_sent %}
        <span>Friend Request Sent</span>
    {% elif req_received %}
        <span>Friend Request Received</span>
    {% endif %}
    <form action="{% url 'chatbox' profile_user.id %}" method="get" style="display:inline;">
        <button type="submit">Message</button>
    </form>
{% else %}
    <span>This is your profile.</span>
{% endif %}
{% endblock %}
